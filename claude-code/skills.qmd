# Skills

Skills are reusable instruction sets that customize Claude Code's behavior for specific tasks. Think of them as "expert modes"—when you're doing git work, the git skill loads; when you're plotting in R, the plotting skill loads.

## How Skills Work

Skills live in folders with a `SKILL.md` file:

```
~/.claude/skills/
├── data-handling/
│   └── SKILL.md
├── r-plotting-style/
│   └── SKILL.md
└── git-conventions/
    └── SKILL.md
```

Claude Code loads relevant skills based on:

- The task you're performing (writing code, committing, plotting)
- File types you're working with (.qmd, .R, .py)
- Keywords in your requests

## Types of Skills

### Background Skills

These load automatically based on context—you don't invoke them directly.

| Skill | When It Activates | What It Does |
|-------|-------------------|--------------|
| `data-handling` | Writing R/Python analysis code | Shows data summaries at key steps (`glimpse()`, row counts); annotates analytical decisions in comments; validates joins to prevent silent data loss; asks you before making important analytical choices |
| `r-plotting-style` | Creating ggplot2 visualizations | Uses `theme_classic()` base with no grid lines; applies `ggrepel` for labels; keeps sizing consistent across related plots |
| `file-safety` | Creating or modifying files | Prevents overwriting collaborator outputs or raw data; creates versioned filenames instead; asks before uncertain overwrites |
| `git-conventions` | Git operations (commit, push, etc.) | Adds co-author line to commits; reviews staged changes; avoids committing secrets or large files |
| `conda-env` | Running Python scripts or pip | Sources conda profile script before activating environments (required in Claude's non-interactive shell) |
| `r-renv` | Working in R projects with renv.lock | Explains "out-of-sync" warnings; reminds about `renv::snapshot()` after installing packages |
| `quarto-docs` | Rendering .qmd files | Uses `quarto render` CLI (not `rmarkdown::render()`); knows format options and common errors |

### User-Invocable Skills (Slash Commands)

These are commands you invoke explicitly by typing `/command`:

| Command | When to Use | What It Does |
|---------|-------------|--------------|
| `/done` | End of a working session | Summarizes accomplishments; checks if renv needs updating; offers to commit changes with descriptive message; optionally publishes Quarto sites |
| `/publish` | After changes to a Quarto book/website | Commits current changes and runs `quarto publish gh-pages` |
| `/quarto-book-setup` | Starting a new documentation project | Creates Quarto book structure with GitHub Pages configuration |

## Anatomy of a Skill

A skill file has two parts:

**1. Frontmatter** — Metadata about the skill

```yaml
---
name: skill-name
description: When to use this skill
user-invocable: false  # or true for /commands
---
```

**2. Instructions** — The actual guidance

```markdown
# Skill Title

## When This Applies
[Conditions when Claude should follow these instructions]

## Instructions
[What Claude should do]

## Examples
[Code patterns and templates]
```

## Example: The data-handling Skill

This skill ensures Claude shows you what's happening to your data:

```markdown
---
name: data-handling
description: Data handling best practices for R and Python analysis scripts
user-invocable: false
---

# Data Handling Best Practices

## Show Data at Key Steps

After loading or transforming data, show dimensions:

\```r
data <- read_csv("data.csv")
cat("Loaded", nrow(data), "rows,", ncol(data), "columns\n")
glimpse(data)
\```

## Validate Joins

Report what happened after joins:

\```r
merged <- left_join(a, b, by = "id")
cat("Joined:", nrow(a), "→", nrow(merged), "rows\n")
cat("Unmatched:", sum(is.na(merged$value)), "\n")
\```

## Ask Before Analytical Decisions

For consequential choices (normalization, thresholds, tests),
present options and ask before proceeding.
```

## Project-Specific Skills

For domain knowledge that only applies to one project, create skills in the project's `.claude/` folder:

```
my-project/.claude/
└── skills/
    └── gene-naming/
        └── SKILL.md
```

### When to Create a Project Skill

- Conventions specific to this project's data
- Domain knowledge Claude needs to apply correctly
- Code patterns that should be consistent across the project

### Example: Gene Naming Skill

```markdown
---
name: gene-naming
description: Gene ID conventions for this transcriptomics project
user-invocable: false
---

# Gene Naming Conventions

## ID Formats
- Trinity IDs: `TRINITY_DN12345_c0_g1_i1`
- Short names: stored in `Gene.short` column
- Official symbols: stored in `Gene.symbol` column

## Joining Pattern

Always join on `trinity_gene_id`, not `Gene.short`:

\```r
# CORRECT
data %>% left_join(annotations, by = "trinity_gene_id")

# WRONG - Gene.short may have duplicates
data %>% left_join(annotations, by = "Gene.short")
\```

## Common Pitfall

Gene names may contain apostrophes (5'→3' exonuclease).
Always normalize:
\```r
mutate(Gene.short = str_replace_all(Gene.short, "'", "'"))
\```
```

## Creating Your Own Skills

### 1. Identify the Pattern

What instructions do you repeat? Common candidates:

- Coding style preferences
- Documentation requirements
- Domain-specific conventions
- Testing practices

### 2. Create the Skill

```bash
# User-level (applies to all projects)
mkdir -p ~/.claude/skills/my-skill

# Project-level (applies to this project only)
mkdir -p .claude/skills/my-skill
```

### 3. Write SKILL.md

```markdown
---
name: my-skill
description: Brief description of what this skill does
user-invocable: false
---

# Skill Title

## Instructions

Be specific. Show examples.

\```r
# Show the pattern you want
example_code()
\```
```

### 4. Test It

Start a new Claude Code session and try a task that should trigger your skill. Refine as needed.

## Skill Best Practices

| Practice | Why |
|----------|-----|
| **Be specific** | Vague instructions produce vague results |
| **Show examples** | Code examples are clearer than descriptions |
| **Keep skills focused** | One skill = one concern |
| **Include the "why"** | Helps Claude make good judgment calls |
| **Update as you learn** | Skills should evolve with your understanding |

## Sharing Skills

Skills are just text files. To share with lab members:

1. Copy the skill folder
2. Have them paste it into their `~/.claude/skills/`

Or include lab-wide skills in a shared repository that everyone clones.
