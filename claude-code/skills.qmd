# Skills

Skills are reusable instruction sets that teach Claude Code how to handle specific types of tasks. They live in `~/.claude/skills/` and activate automatically based on context.

## Why Skills?

Without skills, you'd repeat the same instructions across projects:

- "Use tidyverse style"
- "Show data summaries after transformations"
- "Include co-author attribution in commits"

Skills let you write these instructions once and have them apply automatically.

## How Skills Work

```
~/.claude/skills/
├── data-handling/
│   └── SKILL.md
├── r-plotting-style/
│   └── SKILL.md
└── git-conventions/
    └── SKILL.md
```

Each skill is a folder containing a `SKILL.md` file with instructions. Claude Code loads relevant skills based on:

- Keywords in your requests
- File types you're working with
- Tasks you're performing

## Anatomy of a Skill

A skill file has two parts:

1. **Frontmatter** — Metadata that controls when the skill activates
2. **Instructions** — The actual guidance for Claude Code

```markdown
---
description: Data handling best practices for R and Python analysis scripts
triggers:
  - data manipulation
  - analysis pipelines
  - .qmd scripts that process data
---

# Data Handling Best Practices

## Show Data at Key Steps

Include summaries whenever datasets are created or transformed:

\```r
data <- read_csv("input.csv")
cat("Loaded", nrow(data), "rows,", ncol(data), "columns\n")
glimpse(data)
\```

## Annotate Analytical Decisions

Document the reasoning directly in code:

\```r
# Filter to genes with > 10 counts in at least 3 samples
# Threshold based on recommendation from DESeq2 vignette
keep <- rowSums(counts >= 10) >= 3
counts_filtered <- counts[keep, ]
\```
```

## Example Skills

### Data Handling

```markdown
---
description: Data handling best practices for R and Python analysis scripts
triggers:
  - data manipulation
  - analysis pipelines
  - loading data
  - transforming data
---

# Data Handling Best Practices

## Show Data at Key Steps

After loading or transforming data, show dimensions and a preview:

\```r
data <- read_csv("data.csv")
cat("Loaded", nrow(data), "rows,", ncol(data), "columns\n")
glimpse(data)
\```

\```python
data = pd.read_csv("data.csv")
print(f"Loaded {len(data)} rows, {len(data.columns)} columns")
data.head()
\```

## Validate Joins

When joining datasets, report the result:

\```r
merged <- left_join(a, b, by = "id")
cat("Joined:", nrow(a), "→", nrow(merged), "rows\n")
cat("Unmatched:", sum(is.na(merged$new_column)), "\n")
\```

## Annotate Decisions

Explain non-obvious analytical choices:

\```r
# Using median normalization (not TPM) because samples have
# varying library complexity — see docs/normalization_comparison.html
\```

## Ask Before Deciding

For consequential analytical decisions (filtering thresholds, normalization methods, etc.), present options and ask the user before proceeding.
```

### R Plotting Style

```markdown
---
description: R ggplot2 plotting conventions and theme
triggers:
  - ggplot
  - plotting
  - visualization
  - figures
---

# R Plotting Conventions

## Base Theme

Use `theme_minimal()` as the starting point:

\```r
p <- ggplot(data, aes(x, y)) +
  geom_point() +
  theme_minimal()
\```

## Standard Modifications

\```r
theme_minimal() +
theme(
  axis.text = element_text(size = 11),
  axis.title = element_text(size = 12),
  legend.position = "bottom",
  panel.grid.minor = element_blank()
)
\```

## Color Palettes

- Categorical: `scale_color_brewer(palette = "Set2")`
- Sequential: `scale_color_viridis_c()`
- Diverging: `scale_color_distiller(palette = "RdBu")`

## Figure Dimensions

- Single column: 3.5 × 3 inches
- Double column: 7 × 4 inches
- Save at 300 DPI for publication

\```r
ggsave("figure.png", p, width = 7, height = 4, dpi = 300)
\```
```

### Git Conventions

```markdown
---
description: Git commit practices and conventions
triggers:
  - commit
  - git
  - version control
---

# Git Conventions

## Commit Messages

Write clear, descriptive commit messages:

- Start with a verb (Add, Fix, Update, Remove, Refactor)
- Keep the first line under 50 characters
- Add detail in the body if needed

Good: `Add QC filtering step to preprocessing`
Bad: `updates`

## Co-Author Attribution

Include co-author line when Claude Code contributes substantially:

\```
Add differential expression analysis

Co-Authored-By: Claude Code <noreply@anthropic.com>
\```

## When to Commit

Prompt the user to commit after:

- Completing a logical unit of work
- Before switching to a different task
- After fixing a bug

## What to Commit

- Source code and scripts
- Configuration files (environment.yml, renv.lock)
- Documentation

Never commit:

- Large data files
- Credentials or secrets
- Generated output (unless specifically requested)
```

## Creating Your Own Skills

### Step 1: Identify the Pattern

What instructions do you find yourself repeating? Common candidates:

- Coding style preferences
- Documentation requirements
- Testing practices
- Domain-specific conventions

### Step 2: Create the Skill Folder

```bash
mkdir -p ~/.claude/skills/my-new-skill
```

### Step 3: Write the SKILL.md

```markdown
---
description: Brief description of what this skill does
triggers:
  - keyword1
  - keyword2
  - file pattern or task type
---

# Skill Title

## Section 1

Instructions...

## Section 2

More instructions...
```

### Step 4: Test It

Start a Claude Code session and try a task that should trigger your skill:

```
> [Request that should activate the skill]
```

Check if Claude Code follows your instructions. Refine as needed.

## Skill Best Practices

**Be specific.** Vague instructions produce vague results. Show examples.

**Keep skills focused.** One skill = one concern. Don't combine plotting style with git conventions.

**Use code examples.** Show the pattern you want, not just describe it.

**Include the "why."** When a convention has a reason, explain it—helps Claude Code make good judgment calls.

**Test with edge cases.** Make sure your skill handles variations in how you might phrase requests.

## Organizing Skills

As your skill collection grows, keep it organized:

```
~/.claude/skills/
├── code-style/
│   └── SKILL.md           # General coding style
├── r-plotting/
│   └── SKILL.md           # R visualization
├── python-style/
│   └── SKILL.md           # Python conventions
├── data-handling/
│   └── SKILL.md           # Data manipulation
├── git-conventions/
│   └── SKILL.md           # Version control
└── lab-specific/
    └── SKILL.md           # Lab conventions
```

## Sharing Skills

Skills are just text files. To share with lab members:

1. Copy the skill folder to the shared location
2. Have them copy it to their `~/.claude/skills/`

Or include lab-wide skills in a shared repository that everyone clones.
