<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Your First R Project – Data Analysis in the Musser Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part2/positron.html" rel="next">
<link href="../part1/installation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-f1aadacce99040138bbb613f9330654f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-968d3e63a93d5987d0e6d73d568971dd.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-913b17780ec437ee198ef3e682b8cc2c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-968d3e63a93d5987d0e6d73d568971dd.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part1/intro.html">Quick Start</a></li><li class="breadcrumb-item"><a href="../part1/first-project.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Your First R Project</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data Analysis in the Musser Lab</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Quick Start</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part1/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part1/installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part1/first-project.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Your First R Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Core Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part2/positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Positron</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part2/project-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Project Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part2/quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part2/renv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R: rig &amp; renv</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part2/conda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conda</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part2/git-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Git &amp; GitHub</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Working with AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../claude-code/ai-fluency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">AI Fluency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../claude-code/getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Getting Started with Claude Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../claude-code/teaching-claude.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Teaching Claude About Your Work</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../claude-code/working-effectively.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Working Effectively with Claude</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../claude-code/musser-lab-toolkit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">The Musser Lab Toolkit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../claude-code/staying-safe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Staying Safe</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Workflows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part3/setup-walkthrough.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Setting Up a Lab Project</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part3/starting-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Quick Reference: Project Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part3/collaborating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Collaborating with Others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part3/reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Reproducible Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part3/troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Common Tasks &amp; Troubleshooting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/shortcuts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Keyboard Shortcuts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/commands.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/templates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Templates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">R Packages for Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/lab-skills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Lab Skills Reference</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#create-a-project-folder" id="toc-create-a-project-folder" class="nav-link active" data-scroll-target="#create-a-project-folder"><span class="header-section-number">3.1</span> Create a Project Folder</a></li>
  <li><a href="#install-packages-with-renv" id="toc-install-packages-with-renv" class="nav-link" data-scroll-target="#install-packages-with-renv"><span class="header-section-number">3.2</span> Install Packages with renv</a></li>
  <li><a href="#get-the-data-and-analysis-script" id="toc-get-the-data-and-analysis-script" class="nav-link" data-scroll-target="#get-the-data-and-analysis-script"><span class="header-section-number">3.3</span> Get the Data and Analysis Script</a>
  <ul class="collapse">
  <li><a href="#download-from-github" id="toc-download-from-github" class="nav-link" data-scroll-target="#download-from-github"><span class="header-section-number">3.3.1</span> Download from GitHub</a></li>
  <li><a href="#what-you-should-have" id="toc-what-you-should-have" class="nav-link" data-scroll-target="#what-you-should-have"><span class="header-section-number">3.3.2</span> What you should have</a></li>
  </ul></li>
  <li><a href="#open-the-analysis-script" id="toc-open-the-analysis-script" class="nav-link" data-scroll-target="#open-the-analysis-script"><span class="header-section-number">3.4</span> Open the Analysis Script</a></li>
  <li><a href="#step-1-load-libraries" id="toc-step-1-load-libraries" class="nav-link" data-scroll-target="#step-1-load-libraries"><span class="header-section-number">3.5</span> Step 1: Load Libraries</a></li>
  <li><a href="#step-2-load-the-count-matrix" id="toc-step-2-load-the-count-matrix" class="nav-link" data-scroll-target="#step-2-load-the-count-matrix"><span class="header-section-number">3.6</span> Step 2: Load the Count Matrix</a></li>
  <li><a href="#step-3-quality-control" id="toc-step-3-quality-control" class="nav-link" data-scroll-target="#step-3-quality-control"><span class="header-section-number">3.7</span> Step 3: Quality Control</a></li>
  <li><a href="#step-4-normalize-and-find-variable-features" id="toc-step-4-normalize-and-find-variable-features" class="nav-link" data-scroll-target="#step-4-normalize-and-find-variable-features"><span class="header-section-number">3.8</span> Step 4: Normalize and Find Variable Features</a>
  <ul class="collapse">
  <li><a href="#normalization" id="toc-normalization" class="nav-link" data-scroll-target="#normalization"><span class="header-section-number">3.8.1</span> Normalization</a></li>
  <li><a href="#variable-features" id="toc-variable-features" class="nav-link" data-scroll-target="#variable-features"><span class="header-section-number">3.8.2</span> Variable features</a></li>
  </ul></li>
  <li><a href="#step-5-scale-data-and-run-pca" id="toc-step-5-scale-data-and-run-pca" class="nav-link" data-scroll-target="#step-5-scale-data-and-run-pca"><span class="header-section-number">3.9</span> Step 5: Scale Data and Run PCA</a></li>
  <li><a href="#step-6-cluster-cells" id="toc-step-6-cluster-cells" class="nav-link" data-scroll-target="#step-6-cluster-cells"><span class="header-section-number">3.10</span> Step 6: Cluster Cells</a></li>
  <li><a href="#step-7-visualize-with-umap" id="toc-step-7-visualize-with-umap" class="nav-link" data-scroll-target="#step-7-visualize-with-umap"><span class="header-section-number">3.11</span> Step 7: Visualize with UMAP</a></li>
  <li><a href="#step-8-explore-gene-expression" id="toc-step-8-explore-gene-expression" class="nav-link" data-scroll-target="#step-8-explore-gene-expression"><span class="header-section-number">3.12</span> Step 8: Explore Gene Expression</a></li>
  <li><a href="#step-9-identify-cell-types" id="toc-step-9-identify-cell-types" class="nav-link" data-scroll-target="#step-9-identify-cell-types"><span class="header-section-number">3.13</span> Step 9: Identify Cell Types</a>
  <ul class="collapse">
  <li><a href="#approach-1-unbiased-differential-expression" id="toc-approach-1-unbiased-differential-expression" class="nav-link" data-scroll-target="#approach-1-unbiased-differential-expression"><span class="header-section-number">3.13.1</span> Approach 1: Unbiased differential expression</a></li>
  <li><a href="#approach-2-candidate-genes" id="toc-approach-2-candidate-genes" class="nav-link" data-scroll-target="#approach-2-candidate-genes"><span class="header-section-number">3.13.2</span> Approach 2: Candidate genes</a></li>
  </ul></li>
  <li><a href="#render-the-document" id="toc-render-the-document" class="nav-link" data-scroll-target="#render-the-document"><span class="header-section-number">3.14</span> Render the Document</a></li>
  <li><a href="#what-youve-learned" id="toc-what-youve-learned" class="nav-link" data-scroll-target="#what-youve-learned"><span class="header-section-number">3.15</span> What You’ve Learned</a></li>
  <li><a href="#try-claude-code" id="toc-try-claude-code" class="nav-link" data-scroll-target="#try-claude-code"><span class="header-section-number">3.16</span> Try Claude Code</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next"><span class="header-section-number">3.17</span> What’s Next</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part1/intro.html">Quick Start</a></li><li class="breadcrumb-item"><a href="../part1/first-project.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Your First R Project</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Your First R Project</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, you’ll do a real single-cell RNA-seq analysis—from raw count data to identified cell types. Along the way, you’ll learn how to use Positron’s key features: the file explorer, console, environment pane, plots pane, and interactive code execution. By the end, you’ll render the analysis into a shareable HTML report.</p>
<p>We’ll work with a single-cell RNA-seq dataset from the freshwater sponge <em>Spongilla lacustris</em>, one of the organisms studied in the Musser Lab. The dataset contains about 10,000 cells across 4 samples. Don’t worry about understanding every biological detail—focus on learning how Positron works and getting comfortable running R code interactively. We’ll teach some biology along the way too.</p>
<section id="create-a-project-folder" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="create-a-project-folder"><span class="header-section-number">3.1</span> Create a Project Folder</h2>
<p>First, create a folder for this project and open it in Positron.</p>
<ol type="1">
<li>Open Positron</li>
<li>Go to <strong>File → Open Folder</strong></li>
<li>Navigate to where you want to keep projects (e.g., <code>~/Documents</code>)</li>
<li>Click <strong>New Folder</strong>, name it <code>my-first-analysis</code>, then open it</li>
</ol>
<p>Positron now treats this folder as your workspace. Everything you do—running code, browsing files, managing packages—happens relative to this folder.</p>
<p>Take a moment to look around the Positron interface:</p>
<ul>
<li><strong>File Explorer</strong> (left sidebar): Shows files and folders in your project. Right now it’s empty.</li>
<li><strong>Console</strong> (bottom panel): Where your R session will run. You may need to start one—click “Start R Session” in the status bar at the bottom if you don’t see an R prompt.</li>
<li><strong>Environment pane</strong> (right panel, or bottom panel next to Console): Will show R objects as you create them. Look for the “Variables” tab.</li>
<li><strong>Plots pane</strong>: Will appear when you make your first plot.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/positron-empty-project.png" class="img-fluid figure-img"></p>
<figcaption>Positron with an empty project open</figcaption>
</figure>
</div>
</section>
<section id="install-packages-with-renv" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="install-packages-with-renv"><span class="header-section-number">3.2</span> Install Packages with renv</h2>
<p>Before we can analyze data, we need to install some R packages. We’ll use <strong>renv</strong> to manage packages for this project—renv gives each project its own package library, so installing or updating packages here won’t affect your other projects.</p>
<p>In the R console, type (or paste) and press Enter:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"renv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">init</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>When <code>renv::init()</code> finishes, it will ask you to <strong>restart R</strong>. Do this—in Positron, you can restart by clicking the power icon in the Console toolbar, or pressing <strong>Cmd+Shift+0</strong> (Ctrl+Shift+0 on Windows). Restarting is necessary because renv modifies your <code>.Rprofile</code> to activate itself when R starts, and that only takes effect after a restart.</p>
<p>After restarting, <strong>look at the file explorer</strong>: you should now see <code>renv/</code> and <code>renv.lock</code> appear. The console should also show a message like “renv activated” confirming it’s working.</p>
<p>The <strong>lock file</strong> (<code>renv.lock</code>) is a snapshot of every package installed in your project, including exact version numbers. This is what makes your analysis reproducible—a collaborator (or future you) can run <code>renv::restore()</code> on another machine to install the exact same package versions. You’ll learn more about renv in the <a href="../part2/renv.html">renv chapter</a>.</p>
<p>Now install the packages we need. We use <code>renv::install()</code> rather than <code>install.packages()</code> because it understands how to install packages from multiple sources—CRAN, Bioconductor, and GitHub:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="fu">c</span>(<span class="st">"Seurat"</span>, <span class="st">"leidenbase"</span>, <span class="st">"ggplot2"</span>, <span class="st">"patchwork"</span>, <span class="st">"dplyr"</span>, <span class="st">"here"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This takes a few minutes—Seurat has many dependencies. The <code>leidenbase</code> package is needed for the Leiden clustering algorithm we’ll use later. Watch the console output as packages download and compile. When it’s done, save the state:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>renv::install() and Bioconductor
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>renv::install()</code> is the standard way to install packages in an renv project. For CRAN packages, just use the package name: <code>renv::install("Seurat")</code>. For <strong>Bioconductor</strong> packages (common in genomics—DESeq2, SingleCellExperiment, etc.), prefix with <code>bioc::</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"bioc::DESeq2"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>After installing, always run <code>renv::snapshot()</code> to record the new packages in your lock file.</p>
</div>
</div>
</section>
<section id="get-the-data-and-analysis-script" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="get-the-data-and-analysis-script"><span class="header-section-number">3.3</span> Get the Data and Analysis Script</h2>
<p>We need two things: the <em>Spongilla</em> count matrix and the analysis script you’ll run through. Both are in the book’s GitHub repository.</p>
<section id="download-from-github" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="download-from-github"><span class="header-section-number">3.3.1</span> Download from GitHub</h3>
<p>The example data and scripts live in the <code>examples/</code> folder of the <a href="https://github.com/MusserLab/lab-compute">lab-compute repository</a>. The repository’s README has a description of what’s available — you need two things from it:</p>
<ul>
<li><strong>The Spongilla count matrix</strong> — in <code>examples/data/spongilla_counts/</code> (three files)</li>
<li><strong>The analysis script</strong> — <code>examples/scripts/01_seurat_basics.qmd</code></li>
</ul>
<p>The easiest way to get them is to download the whole repository as a ZIP file:</p>
<ol type="1">
<li>Go to <a href="https://github.com/MusserLab/lab-compute">github.com/MusserLab/lab-compute</a></li>
<li>Click the green <strong>Code</strong> button, then <strong>Download ZIP</strong></li>
<li>Unzip the downloaded file — you’ll find an <code>examples/</code> folder inside</li>
</ol>
<p>Now create the project folders and copy the files in. Open a terminal in your project folder (in Positron: <strong>Terminal → New Terminal</strong>, or Cmd+` / Ctrl+`).</p>
<p><strong>macOS:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mkdir -p data scripts outs</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cp -r ~/Downloads/lab-compute-main/examples/data/spongilla_counts data/</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>cp ~/Downloads/lab-compute-main/examples/scripts/01_seurat_basics.qmd scripts/</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Windows PowerShell:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mkdir data, scripts, outs</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Copy-Item -Recurse ~\Downloads\lab-compute-main\examples\data\spongilla_counts data\</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Copy-Item ~\Downloads\lab-compute-main\examples\scripts\01_seurat_basics.qmd scripts\</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Or do it by hand: create <code>data/</code>, <code>scripts/</code>, and <code>outs/</code> folders in Positron’s File Explorer (right-click → <strong>New Folder</strong>), then drag the files from the unzipped download into the right places.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The outs/ folder
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>outs/</code> folder is empty for now — you’ll use it later when rendering the analysis to HTML. In the lab we keep script outputs separate from source code so things stay organized.</p>
</div>
</div>
</section>
<section id="what-you-should-have" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="what-you-should-have"><span class="header-section-number">3.3.2</span> What you should have</h3>
<p>Your project should now look like this:</p>
<pre><code>my-first-analysis/
├── data/
│   └── spongilla_counts/
│       ├── barcodes.tsv.gz        # One barcode per cell
│       ├── features.tsv.gz        # One row per gene
│       └── matrix.mtx.gz          # The sparse count matrix
├── scripts/
│   └── 01_seurat_basics.qmd      # The analysis you'll run
├── outs/                          # Will hold script outputs
├── renv/
├── renv.lock
└── .Rprofile</code></pre>
<p>The three files in <code>spongilla_counts/</code> are the standard <strong>10X Genomics format</strong>—the same format you’ll get when analyzing your own single-cell data from a sequencing core. The barcodes file has one entry per cell, the features file lists every gene, and the matrix file stores the actual counts in a compressed sparse format (most gene-cell combinations are zero, so this saves a lot of space).</p>
<p><strong>Look at the file explorer now.</strong> You can click into folders to browse their contents. Click into <code>data/spongilla_counts/</code> to see the three files.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/project-structure.png" class="img-fluid figure-img"></p>
<figcaption>File explorer showing the project structure</figcaption>
</figure>
</div>
</section>
</section>
<section id="open-the-analysis-script" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="open-the-analysis-script"><span class="header-section-number">3.4</span> Open the Analysis Script</h2>
<p>Open <code>scripts/01_seurat_basics.qmd</code> by clicking on it in the file explorer.</p>
<p>This is a <strong>Quarto document</strong> (<code>.qmd</code>)—the format we use for analyses in the lab. If you’ve used RMarkdown before, Quarto is its successor: it has the same idea of mixing code and narrative, but with more features and equal support for both R and Python. When you render a <code>.qmd</code>, all the code runs and the results are woven into an HTML report.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/qmd-in-editor.png" class="img-fluid figure-img"></p>
<figcaption>The QMD file open in the editor</figcaption>
</figure>
</div>
<p>Look at the structure of the file. There are three kinds of content:</p>
<p><strong>The YAML header</strong> is the block between <code>---</code> marks at the top. It controls metadata—title, author, date—and rendering options like output format and whether to show code. You’ll see comments (lines starting with <code>#</code>) explaining what each option does. The YAML header is the first thing Quarto reads when rendering.</p>
<p><strong>Markdown text</strong> is the written explanation between code chunks. Markdown is a lightweight formatting language: <code>**bold**</code> for <strong>bold</strong>, <code>*italic*</code> for <em>italic</em>, <code>##</code> for section headings, and <code>[link text](url)</code> for hyperlinks. The Quarto document itself has a brief Markdown introduction at the top—read through it to get oriented.</p>
<p><strong>Code chunks</strong> are blocks starting with <code>```{r}</code> and ending with <code>```</code>. Each chunk has options on lines starting with <code>#|</code>. The most important is <code>#| label:</code> which gives the chunk a name. Other options control things like figure captions (<code>#| fig-cap:</code>) and figure dimensions. The first chunk in the script has comments explaining common chunk options.</p>
<p>We’re going to run through this script <strong>chunk by chunk</strong>, interactively. This is how you’ll develop analyses in the lab—running code, inspecting results, and iterating before rendering the final report.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Cmd+Enter: Your Most-Used Shortcut
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Cmd+Enter</strong> (Ctrl+Enter on Windows) runs the current line or selection in the R console. <strong>Cmd+Shift+Enter</strong> runs the entire code chunk. You’ll use these constantly during interactive development.</p>
</div>
</div>
</section>
<section id="step-1-load-libraries" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="step-1-load-libraries"><span class="header-section-number">3.5</span> Step 1: Load Libraries</h2>
<p>Find the first code chunk (labeled <code>setup</code>) and place your cursor inside it. Press <strong>Cmd+Shift+Enter</strong> to run the entire chunk.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Watch the console</strong> at the bottom—you’ll see library loading messages appear there. The code runs in the console, not in the document. This is <strong>interactive execution</strong>: you’re exploring and developing, running code chunk by chunk, checking results as you go.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/console-library-loading.png" class="img-fluid figure-img"></p>
<figcaption>Console showing library loading messages</figcaption>
</figure>
</div>
</section>
<section id="step-2-load-the-count-matrix" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="step-2-load-the-count-matrix"><span class="header-section-number">3.6</span> Step 2: Load the Count Matrix</h2>
<p>Run the next chunk (<code>load-data</code>). This loads the 10X count matrix and creates a Seurat object—the central data structure for single-cell analysis in R. It stores the count matrix, cell metadata, dimensionality reductions, and clustering results all in one container.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">Read10X</span>(<span class="at">data.dir =</span> <span class="fu">here</span>(<span class="st">"data/spongilla_counts"</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(<span class="at">counts =</span> counts, <span class="at">project =</span> <span class="st">"spongilla"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sponge</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Two things to notice:</p>
<ol type="1">
<li><strong>The console</strong> prints a summary of the Seurat object: the number of genes (features) and cells (samples) in the dataset.</li>
<li><strong>The environment pane</strong> (Variables tab) now shows two objects: <code>counts</code> (a sparse matrix) and <code>sponge</code> (a Seurat object). You can see the object type and size at a glance.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/environment-pane-objects.png" class="img-fluid figure-img"></p>
<figcaption>Environment pane showing the counts and sponge objects</figcaption>
</figure>
</div>
<p>Now let’s inspect the cell metadata. Run the <code>peek-metadata</code> chunk—it uses <code>head()</code> to print the first few rows of the metadata table to the console. That’s useful for a quick look, and it’s what we use in the script because <code>head()</code> works when the document is rendered to HTML later.</p>
<p>But for interactive exploration, try typing this directly in the console:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(sponge<span class="sc">@</span>meta.data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This opens Positron’s <strong>data viewer</strong>—a spreadsheet-style view of the metadata, with one row per cell. <code>View()</code> only works interactively (it opens a GUI pane), which is why the script uses <code>head()</code> instead. You’ll see three columns:</p>
<ul>
<li><strong>orig.ident</strong> — which sample the cell came from</li>
<li><strong>nCount_RNA</strong> — total UMI counts per cell (how much RNA was captured)</li>
<li><strong>nFeature_RNA</strong> — number of distinct genes detected per cell</li>
</ul>
<p>Notice two useful features of the data viewer:</p>
<ul>
<li><strong>Column histograms</strong>: Each numeric column shows a small histogram at the top, giving you a quick summary of the distribution. You can immediately see the range and shape of <code>nCount_RNA</code> and <code>nFeature_RNA</code> without making a plot.</li>
<li><strong>Filtering</strong>: Click on a column header to filter rows. For example, you could filter <code>nFeature_RNA</code> to only show cells with more than 1,000 detected genes. This is useful for quickly exploring subsets of your data.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/data-viewer-metadata.png" class="img-fluid figure-img"></p>
<figcaption>Data Viewer showing Seurat metadata with column histograms</figcaption>
</figure>
</div>
</section>
<section id="step-3-quality-control" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="step-3-quality-control"><span class="header-section-number">3.7</span> Step 3: Quality Control</h2>
<p>Run the next chunk (<code>fig-qc-violin</code>). This creates violin plots of two key QC metrics:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(sponge, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>, <span class="st">"nCount_RNA"</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Your first plot appears in the Plots pane!</strong> The violin plots show the distribution of genes and UMI counts across all cells. You can resize the Plots pane by dragging its border, and use the navigation arrows to flip between plots as you make more.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/qc-violin-plot.png" class="img-fluid figure-img"></p>
<figcaption>QC violin plots in the Plots pane</figcaption>
</figure>
</div>
<p>Here’s what to look for in these plots:</p>
<p><strong>nCount_RNA</strong> (total UMI counts) varies naturally by cell type. Large cells or transcriptionally active cells capture more RNA, so higher counts don’t necessarily mean better quality. On the other hand, very high counts can indicate <strong>doublets</strong>—droplets that accidentally captured two cells during the 10X run, giving them roughly double the expected RNA content. Very low counts suggest empty droplets or dead cells.</p>
<p><strong>nFeature_RNA</strong> (genes detected) gives a sense of library complexity. A cell with very few detected genes may not have been captured well. Differences between samples are normal and can reflect both biology and technical variation.</p>
<p>This dataset has already been quality-filtered, so the distributions should look clean.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Pop Out the Plots Pane
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want a larger view of a plot, you can pop the Plots pane out into a separate window. Click the pop-out icon in the top-right corner of the Plots pane. This is especially useful for complex plots where you want to see fine detail.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>QC Filtering in Practice
</div>
</div>
<div class="callout-body-container callout-body">
<p>With raw, unfiltered data, you’d typically remove obvious junk cells—those with extremely low gene counts or extremely high counts that suggest doublets. But in practice, many experienced analysts set only very lenient thresholds at this stage, or none at all. The reason is that clustering itself is a powerful QC tool: cells with low-quality profiles often group together into their own “junk clusters” that you can remove later, after seeing how cells actually behave. This is more nuanced than applying hard cutoffs upfront, because some cells with low RNA counts are perfectly real (they’re just small or quiescent cells), and hard thresholds would throw them out.</p>
<p>Programs like <strong>DoubletFinder</strong> can also identify likely doublets computationally, which is more principled than a simple nCount_RNA threshold.</p>
</div>
</div>
</section>
<section id="step-4-normalize-and-find-variable-features" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="step-4-normalize-and-find-variable-features"><span class="header-section-number">3.8</span> Step 4: Normalize and Find Variable Features</h2>
<p>Run the <code>normalize</code> chunk. This does two things.</p>
<section id="normalization" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="normalization"><span class="header-section-number">3.8.1</span> Normalization</h3>
<p><code>NormalizeData()</code> adjusts for differences in sequencing depth between cells. It divides each cell’s gene counts by the cell’s total UMI count to get relative expression levels, then applies a log transformation. The log transformation addresses <em>heteroscedasticity</em>: without it, highly expressed genes would have much higher variance than lowly expressed genes, dominating downstream analyses.</p>
<p>A word of caution: it’s often stated that differences in total RNA per cell are purely technical artifacts of sequencing depth. That can be true when comparing closely related cell types. But in whole-organism datasets like this one—where cells range from tiny pinacocytes to large, transcriptionally active archaeocytes—differences in total RNA abundance are genuinely biological. Normalization can flatten out real biology in these cases. This step is a useful default, but not a biological law.</p>
<p>Not all methods even require this step. Casey Dunn and colleagues have developed approaches that work directly in count space, avoiding the assumptions baked into log-normalization. As you gain experience, it’s worth understanding what normalization does and when alternatives might be more appropriate.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(sponge)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(sponge, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="variable-features" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="variable-features"><span class="header-section-number">3.8.2</span> Variable features</h3>
<p><code>FindVariableFeatures()</code> identifies the 2,000 genes whose expression varies most across cells. The idea is that genes expressed at similar levels in every cell don’t have much to say about the structure of the data—they won’t help distinguish cell types. By focusing on the most variable genes, the downstream analysis is more efficient and less noisy.</p>
<p>This is a reasonable heuristic, but it’s not the only approach. Methods like <strong>SAM</strong> (Self-Assembling Manifolds) take a different tack: they use <em>all</em> genes but weight them by how informative they are for finding structure, rather than discarding genes outright. The “select top 2,000 variable features” convention is one way to do this, not the only way.</p>
<p>Now run the <code>fig-variable-features</code> chunk to visualize the results:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(sponge), <span class="dv">10</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(sponge)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">LabelPoints</span>(<span class="at">plot =</span> plot1, <span class="at">points =</span> top10, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plot2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>A new plot appears in the <strong>Plots pane</strong> showing genes ranked by variability. The labeled points are the top 10 most variable genes. <strong>Use the navigation arrows</strong> in the Plots pane to flip between this plot and the earlier violin plot.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/variable-features-plot.png" class="img-fluid figure-img"></p>
<figcaption>Variable features plot with top genes labeled</figcaption>
</figure>
</div>
</section>
</section>
<section id="step-5-scale-data-and-run-pca" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="step-5-scale-data-and-run-pca"><span class="header-section-number">3.9</span> Step 5: Scale Data and Run PCA</h2>
<p>Run the <code>scale-pca</code> chunk:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(sponge)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(sponge)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Scaling</strong> shifts each gene to have mean 0 and variance 1. Together with the log normalization from the previous step, this ensures that both lowly and highly expressed genes contribute equally to the analysis. <strong>PCA</strong> (Principal Component Analysis) then reduces the data from thousands of genes down to a smaller number of dimensions (principal components) that capture the main axes of variation.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>A Note on Methods
</div>
</div>
<div class="callout-body-container callout-body">
<p>Scaling followed by PCA is the standard Seurat workflow and a reasonable starting point for most datasets. Other approaches exist—for example, <strong>SAM</strong> (Self-Assembling Manifolds) skips the variable feature selection and PCA steps entirely and can work well, particularly for complex datasets. The Seurat pipeline is one well-established starting point, but it’s worth knowing that alternatives exist and may be better suited to your particular data.</p>
</div>
</div>
<p>Now run the <code>fig-elbow</code> chunk to see the elbow plot:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(sponge, <span class="at">ndims =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The elbow plot shows how much variation each PC explains. We need to choose how many PCs to use for clustering. The “elbow”—where the curve flattens—gives a rough guide, but in practice we often include more PCs than the elbow alone might suggest. The reason: later PCs can capture variation from rare cell types that would be missed with too few dimensions. Using too few PCs has a real cost—clusters that should be separate may merge together, and you’ll miss biology. We’ll use 40 PCs for this dataset, which is deliberately generous.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/elbow-plot.png" class="img-fluid figure-img"></p>
<figcaption>Elbow plot in the Plots pane</figcaption>
</figure>
</div>
</section>
<section id="step-6-cluster-cells" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="step-6-cluster-cells"><span class="header-section-number">3.10</span> Step 6: Cluster Cells</h2>
<p>Run the <code>cluster</code> chunk. This is the most computationally intensive step—it takes a moment.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(sponge, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(sponge, <span class="at">resolution =</span> <span class="dv">2</span>, <span class="at">algorithm =</span> <span class="dv">4</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sponge <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(sponge, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Three things happen here:</p>
<ul>
<li><strong>FindNeighbors</strong> builds a graph connecting cells with similar expression profiles (using the first 40 PCs).</li>
<li><strong>FindClusters</strong> uses the Leiden algorithm to find communities of similar cells in that graph.</li>
<li><strong>RunUMAP</strong> projects the high-dimensional relationships into two dimensions for visualization.</li>
</ul>
<p>When it finishes, <strong>check the environment pane</strong>—the <code>sponge</code> object now contains clustering results and UMAP coordinates. Run <code>View(sponge@meta.data)</code> again to see a new <code>seurat_clusters</code> column in the metadata.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Clustering Parameters
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>dims = 1:40</strong> — uses the first 40 PCs. We deliberately include more than the elbow suggests to catch rare cell types.</li>
<li><strong>resolution = 2</strong> — higher values produce more clusters. The right resolution depends on how many cell types you expect and how finely you want to split them.</li>
<li><strong>algorithm = 4</strong> — Leiden algorithm, which generally produces more robust clusters than the default Louvain (algorithm = 1).</li>
</ul>
</div>
</div>
</section>
<section id="step-7-visualize-with-umap" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="step-7-visualize-with-umap"><span class="header-section-number">3.11</span> Step 7: Visualize with UMAP</h2>
<p>Run the <code>fig-umap</code> chunk:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(sponge, <span class="at">reduction =</span> <span class="st">"umap"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">NoLegend</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The UMAP is one of many ways to look at single-cell data. Each dot is a cell, colored by cluster, and cells that are close together have similar gene expression. It’s a useful 2D summary of relationships among thousands of genes, but it’s important not to over-interpret distances or shapes—UMAP is a visualization tool, not an analysis endpoint. The real work is figuring out what each cluster <em>is</em>, which we’ll do next.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/umap-clusters.png" class="img-fluid figure-img"></p>
<figcaption>UMAP with cluster labels</figcaption>
</figure>
</div>
</section>
<section id="step-8-explore-gene-expression" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="step-8-explore-gene-expression"><span class="header-section-number">3.12</span> Step 8: Explore Gene Expression</h2>
<p>Run the <code>fig-features</code> chunk:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(sponge, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Eef1a1 A"</span>, <span class="st">"Pcna"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This overlays gene expression onto the UMAP—each cell is colored by how strongly it expresses that gene. <em>Eef1a1</em> is an elongation factor that marks archaeocytes (the stem cell-like cells of sponges), and <em>Pcna</em> is a proliferation marker (it labels cells that are actively dividing). Notice how expression is concentrated in specific clusters, not spread uniformly. This is what makes these genes useful as markers for identifying cell types.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/featureplot-eef1a1-pcna.png" class="img-fluid figure-img"></p>
<figcaption>FeaturePlot of Eef1a1 A and Pcna</figcaption>
</figure>
</div>
</section>
<section id="step-9-identify-cell-types" class="level2" data-number="3.13">
<h2 data-number="3.13" class="anchored" data-anchor-id="step-9-identify-cell-types"><span class="header-section-number">3.13</span> Step 9: Identify Cell Types</h2>
<p>Now the interesting part: figuring out what each cluster actually is. There are two complementary approaches, and you’ll typically use both.</p>
<section id="approach-1-unbiased-differential-expression" class="level3" data-number="3.13.1">
<h3 data-number="3.13.1" class="anchored" data-anchor-id="approach-1-unbiased-differential-expression"><span class="header-section-number">3.13.1</span> Approach 1: Unbiased differential expression</h3>
<p>We can ask which genes are most enriched in a given cluster compared to all other cells. This is <strong>unbiased</strong>—we let the data tell us what’s distinctive about a cluster without assuming anything in advance.</p>
<p>Run the <code>de-cluster1</code> chunk to find markers for the largest cluster (cluster 1):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>markers_c1 <span class="ot">&lt;-</span> <span class="fu">FindMarkers</span>(sponge, <span class="at">ident.1 =</span> <span class="dv">1</span>, <span class="at">min.pct =</span> <span class="fl">0.25</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(markers_c1, <span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The output shows genes ranked by statistical significance, with columns for log fold-change, detection rates, and adjusted p-values. Scroll through the top genes and look for patterns—are there gene families that keep coming up?</p>
<p>Now run the <code>fig-dotplot-c1</code> chunk to visualize these markers across all clusters:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>top_genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(<span class="fu">head</span>(markers_c1, <span class="dv">15</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(sponge, <span class="at">features =</span> top_genes, <span class="at">scale =</span> F, <span class="at">cols =</span> <span class="st">"RdBu"</span>) <span class="sc">+</span> <span class="fu">RotatedAxis</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In the <strong>dot plot</strong>, dot size shows what fraction of cells in each cluster express the gene, and dot color shows average expression level. Look for genes that are strongly expressed in cluster 1 but absent or low in most other clusters.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/dotplot-de-markers.png" class="img-fluid figure-img"></p>
<figcaption>Dot plot of top markers for cluster 1</figcaption>
</figure>
</div>
<p>You’ll see ribosomal genes (names starting with <em>Rpl</em> or <em>Rps</em>) dominating the top markers. This signature—high ribosomal gene expression indicating active protein synthesis—is characteristic of <strong>archaeocytes</strong>. Archaeocytes are the stem cell-like cells of sponges, and similar transcriptional profiles mark stem cells in many invertebrates.</p>
</section>
<section id="approach-2-candidate-genes" class="level3" data-number="3.13.2">
<h3 data-number="3.13.2" class="anchored" data-anchor-id="approach-2-candidate-genes"><span class="header-section-number">3.13.2</span> Approach 2: Candidate genes</h3>
<p>The complementary strategy is to take genes you already know something about and look at where they’re expressed. This is the <strong>candidate gene</strong> approach.</p>
<p><em>Piwi</em> genes are highly conserved markers of stem cells and germline across animals. If archaeocytes are truly stem cell-like, they should express <em>Piwi</em>. Run the <code>find-piwi</code> chunk to search for it:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">"iwi"</span>, <span class="fu">rownames</span>(sponge), <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This is a useful trick—when you don’t know the exact gene name in a dataset, <code>grep()</code> lets you search by partial match. You should see <code>Piwil2</code> and <code>Piwil1/3/4</code> in the results. Now run the <code>fig-piwi</code> chunk to see where <em>Piwil2</em> is expressed:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">VlnPlot</span>(sponge, <span class="at">features =</span> <span class="st">"Piwil2"</span>, <span class="at">pt.size =</span> <span class="fl">0.1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">FeaturePlot</span>(sponge, <span class="at">features =</span> <span class="st">"Piwil2"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The <strong>VlnPlot</strong> shows which clusters express <em>Piwil2</em> most strongly. The <strong>FeaturePlot</strong> shows where those cells sit on the UMAP. If <em>Piwil2</em> expression is concentrated in the same cluster that showed the ribosomal signature in the DE analysis, that’s convergent evidence: two independent approaches pointing to the same biological identity.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/piwi-expression.png" class="img-fluid figure-img"></p>
<figcaption>Piwi expression — VlnPlot and FeaturePlot</figcaption>
</figure>
</div>
<p>This two-pronged strategy—unbiased differential expression to discover what’s distinctive, plus candidate genes to confirm identity—is a standard approach for annotating clusters in single-cell data.</p>
</section>
</section>
<section id="render-the-document" class="level2" data-number="3.14">
<h2 data-number="3.14" class="anchored" data-anchor-id="render-the-document"><span class="header-section-number">3.14</span> Render the Document</h2>
<p>So far you’ve been running code <strong>interactively</strong>—chunk by chunk, with results appearing in the console, environment pane, and plots pane. This is how you develop and explore.</p>
<p>Now let’s <strong>render</strong> the document. Rendering runs every code chunk in a <strong>fresh R session</strong> from top to bottom, and produces a polished HTML report. This is important because:</p>
<ul>
<li>It proves the analysis is <strong>reproducible</strong>—it runs start to finish without relying on objects you created interactively</li>
<li>It catches <strong>errors</strong> you might miss during interactive development (like relying on a variable you defined in the console but forgot to include in the script)</li>
<li>It produces a <strong>shareable document</strong> with all code, results, and narrative together</li>
</ul>
<p>Open the terminal (Cmd+` or Ctrl+`) and run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>quarto render scripts/01_seurat_basics.qmd</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mkdir -p outs/01_seurat_basics</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>mv scripts/01_seurat_basics.html outs/01_seurat_basics/</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The first command renders the document—Quarto re-executes all your R code from scratch. Then we move the HTML output into the <code>outs/</code> folder, following the lab convention of keeping script outputs separate from source code. In Part 2, you’ll learn about additional conventions for this folder, like <code>BUILD_INFO.txt</code> files that track which code version produced each output. For now, just getting the output into the right place is enough. When it finishes, open <code>outs/01_seurat_basics/01_seurat_basics.html</code> in your browser to see the full analysis as a formatted report—code, plots, and your written explanations all together.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/first-project/rendered-html-report.png" class="img-fluid figure-img"></p>
<figcaption>The rendered HTML report in a browser</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Interactive vs.&nbsp;Rendering
</div>
</div>
<div class="callout-body-container callout-body">
<p>During development, <strong>work interactively</strong>—run chunks, inspect objects, iterate. When you’re satisfied, <strong>render</strong> to confirm everything runs cleanly and to produce the final report. If rendering fails, the error messages tell you where the problem is.</p>
</div>
</div>
</section>
<section id="what-youve-learned" class="level2" data-number="3.15">
<h2 data-number="3.15" class="anchored" data-anchor-id="what-youve-learned"><span class="header-section-number">3.15</span> What You’ve Learned</h2>
<p>You’ve now used all of Positron’s key features:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>What you used it for</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>File Explorer</strong></td>
<td>Browsing project files, seeing data and output structure</td>
</tr>
<tr class="even">
<td><strong>Console</strong></td>
<td>Running R code interactively, seeing output and messages</td>
</tr>
<tr class="odd">
<td><strong>Environment pane</strong></td>
<td>Inspecting R objects—their types, sizes, and contents</td>
</tr>
<tr class="even">
<td><strong>Data Viewer</strong></td>
<td>Examining cell metadata with filtering and column histograms</td>
</tr>
<tr class="odd">
<td><strong>Plots pane</strong></td>
<td>Viewing violin plots, UMAP, feature plots, dot plots (with pop-out)</td>
</tr>
<tr class="even">
<td><strong>Terminal</strong></td>
<td>Running <code>quarto render</code> to produce the HTML report</td>
</tr>
</tbody>
</table>
<p>And you’ve run a single-cell analysis from start to finish:</p>
<ol type="1">
<li><strong>Loaded</strong> a 10X count matrix into a Seurat object</li>
<li><strong>Inspected</strong> QC metrics to check data quality across samples</li>
<li><strong>Normalized</strong> and identified highly variable genes</li>
<li><strong>Scaled</strong>, ran <strong>PCA</strong>, and chose dimensions with an elbow plot</li>
<li><strong>Clustered</strong> cells with the Leiden algorithm</li>
<li><strong>Visualized</strong> clusters on a UMAP and explored gene expression</li>
<li><strong>Identified cell types</strong> using both unbiased differential expression and candidate gene markers</li>
</ol>
<p>This is the starting point for single-cell analysis in the lab. The tools and workflow you’ve practiced here—interactive development in Positron, Quarto for reproducible reports, Seurat for analysis—are what you’ll use for your own projects.</p>
</section>
<section id="try-claude-code" class="level2" data-number="3.16">
<h2 data-number="3.16" class="anchored" data-anchor-id="try-claude-code"><span class="header-section-number">3.16</span> Try Claude Code</h2>
<p>You installed Claude Code in the previous chapter. Now that you have a real project with real data, try it out. Open the Claude Code panel in Positron’s sidebar (or run <code>claude</code> in the terminal).</p>
<p>Sponges don’t have canonical muscles, but the flat epithelial cells covering the sponge surface—<strong>pinacocytes</strong>—have been described to express muscle-related genes like myosins. Let’s explore this with Claude Code:</p>
<div class="claude-callout callout callout-style-default callout-warning callout-titled" title="Claude Code">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Claude Code
</div>
</div>
<div class="callout-body-container callout-body">
<p>Claude Code can read your project files, understand your analysis, and write R code in context.</p>
<blockquote class="blockquote">
<p>I’m analyzing Spongilla single-cell data with Seurat. Can you find all myosin genes in the dataset (search for “Myh” and “Myl” in the gene names) and make FeaturePlots and VlnPlots for any that show interesting expression patterns? The Seurat object is called <code>sponge</code>.</p>
</blockquote>
<p>Claude will search the gene names in your Seurat object, identify the myosin genes present, check their expression patterns, and create plots of the ones that show cluster-specific expression—all without you needing to write the R code yourself.</p>
</div>
</div>
<p>Try the prompts in these orange boxes as you encounter them throughout the book—Claude Code works best when you give it specific context about what you’re working on.</p>
</section>
<section id="whats-next" class="level2" data-number="3.17">
<h2 data-number="3.17" class="anchored" data-anchor-id="whats-next"><span class="header-section-number">3.17</span> What’s Next</h2>
<ul>
<li><strong>Part 2</strong> dives deeper into each tool: the <a href="../part2/positron.html">Positron chapter</a> covers more features and keyboard shortcuts, the <a href="../part2/quarto.html">Quarto chapter</a> covers document syntax and options, and the <a href="../part2/project-organization.html">Project Organization chapter</a> explains the lab’s conventions for structuring projects.</li>
<li><strong>The <a href="../part3/setup-walkthrough.html">Workflows</a> section</strong> shows how to set up a full lab project with Git, conda, proper folder structure, and GitHub—the production infrastructure you’ll use for real analyses.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part1/installation.html" class="pagination-link" aria-label="Installation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part2/positron.html" class="pagination-link" aria-label="Positron">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Positron</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>